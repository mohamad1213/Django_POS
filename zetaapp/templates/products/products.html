{% extends 'base_pos.html' %}{% load static %}
{% load sass_tags %}
{% load humanize %}
{% block css %}
<!-- Plugins css start-->
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/scrollbar.scss' %}">
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/datatables.scss' %}">
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/owlcarousel.scss' %}">
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/rating.scss' %}">
<!-- Plugins css Ends-->
{% endblock css %}
{% block content %}
<div class="page-body">
    {% include 'layout_pos/breadcrumb.html' %}

    <!-- Container-fluid starts-->
    <div class="container-fluid list-products">

        <!-- DataTable -->
        <div class="card shadow mb-12">
            <div class="card-body">
                <div class="row ml-0 mb-3" style="text-align: right;">
                    <a href="{% url 'products:products_add' %}">
                        <button type="button" class="btn btn-primary font-weight-bold">
                            <i class="fas fa-plus mr-2"></i>
                            Tambah barang
                        </button>
                    </a>
                </div>
                <div class="table-responsive">
                    <div id="custom-buttons"></div>    
                    <table class="table table-bordered display table-striped dataTable no-footer" id="prodata">
                        <thead>
                            <tr>
                                <th>NO</th>
                                <th>Nama</th>
                                <th>Kategori</th>
                                <th class="text-center" >Harga</th>
                                <th class="text-center" >Status</th>
                                <th class="text-center" >Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for p in products %}
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{p.name}}</td>
                                <td>{{p.category}}</td>
                                <td class="text-right">{{p.price|floatformat:0|intcomma }}</td>
                                {% if p.status == "ACTIVE" %}
                                <td class="text-center">
                                    <span class="badge badge-success" style="font-size:0.8em;">{{p.status}}</span>
                                </td>
                                {% elif p.status == "INACTIVE" %}
                                <td class="text-center">
                                    <span class="badge badge-danger" style="font-size:0.8em;">{{p.status}}</span>
                                </td>
                                {% endif %}
                                <td class="text-center">
                                    <!--Update-->
                                    <a href="{% url 'products:products_update' p.id %}" class="text-decoration-none">
                                        <button type="button" class="btn btn-warning btn-sm" data-bs-toggle="tooltip"
                                            title="Update product">
                                            <i class="fas fa-pen"></i>
                                        </button>
                                    </a>
                                    <!--Delete modal-->
                                    <!-- Button trigger modal -->
                                    <a class="text-decoration-none">
                                        <button rel="delete" type="button" class="btn btn-danger btn-sm"
                                            data-bs-toggle="modal" data-bs-target="#exampleModal">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </a>

                                    <!-- Modal -->
                                    <div class="modal fade" id="exampleModal" tabindex="-1"
                                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Hapus Barang</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <p>{{p.name}}</p>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                        data-bs-dismiss="modal">Batal</button>
                                                    <a href="#" class="text-decoration-none">
                                                        <a id="updateThisURL"
                                                            href="{% url 'products:products_delete' p.id %}"
                                                            class="text-decoration-none">
                                                            <button type="button" class="btn btn-danger">Hapus</button>
                                                        </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
{% block scriptcontent %}
<!-- Plugins JS start-->
<script src="{% static 'assets/js/sidebar-menu.js' %}"></script>
<script src="{% static 'assets/js/datatable/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'assets/js/rating/jquery.barrating.js' %}"></script>
<script src="{% static 'assets/js/rating/rating-script.js' %}"></script>
<script src="{% static 'assets/js/owlcarousel/owl.carousel.js' %}"></script>
<script src="{% static 'assets/js/ecommerce.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
<script src="{% static 'assets/js/product-list-custom.js' %}"></script>\
<!-- Datatables -->
<script src="{% static 'vendor/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'vendor/datatables/dataTables.bootstrap4.min.js' %}"></script>
<!--Datatable buttons-->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.3.3/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.3.3/js/buttons.colVis.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.3.3/js/buttons.html5.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.3.3/js/buttons.print.min.js"></script>
<!--Moment JS-->
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>

<!--Datatables-->
<script>
    // Call the dataTables jQuery plugin
    $(document).ready(function () {
        var tblProducts = $('#prodata').DataTable({
            dom: "<'row'<'col-sm-6'l><'col-sm-6'f>>" + // Layout lebih rapi: left = length, right = search
                "<'row'<'col-sm-12'tr>>" +
                "<'row'<'col-sm-5'i><'col-sm-7'p>>", // Informasi dan pagination di bawah
            buttons: [
                {
                    extend: 'print',
                    text: '<i class="fas fa-print"></i> Print',
                    titleAttr: 'Cetak Data',
                    className: 'btn btn-primary btn-sm',
                    exportOptions: {
                        columns: ':visible' // Hanya kolom yang terlihat yang dicetak
                    },
                    customize: function (win) {
                        $(win.document.body).css('font-size', '12px'); // Ukuran font cetak lebih kecil
                        $(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
                    }
                },
            ],
            paging: true,
            autoWidth: false,
            responsive: true, // Tabel responsif di mobile
            columnDefs: [
                { targets: [0], className: "text-center" }, // Kolom pertama rata tengah
                { targets: "_all", className: "align-middle" } // Semua kolom vertikal tengah
            ],
            language: {
                search: "Cari:",
                lengthMenu: "Tampilkan _MENU_ data",
                info: "Menampilkan _START_ - _END_ dari _TOTAL_ data",
                paginate: {
                    first: "Awal",
                    last: "Akhir",
                    next: "→",
                    previous: "←"
                }
            }
        });

        // Tambahkan tombol ke dalam div custom
        tblProducts.buttons().container().appendTo('#custom-buttons');
    });


</script>
{% endblock scriptcontent %}