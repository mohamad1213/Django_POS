{% extends 'base.html' %}{% load static %}
{% load sass_tags %}
{% block css %}
<!-- Plugins css start-->
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/scrollbar.scss' %}">
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/datatables.scss' %}">
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/owlcarousel.scss' %}">
<link rel="stylesheet" type="text/css" href="{% sass_src 'assets/scss/vendors/rating.scss' %}">
<!-- Plugins css Ends-->
{% endblock css %}
{% block content %}
<style>
  /* styling sederhana untuk card stat */
  .stat-card {
    border-radius: 12px;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
  }

  .stat-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
  }

  .stat-icon {
    width: 48px;
    height: 48px;
    flex: 0 0 48px;
  }

  .stat-title {
    font-size: 0.95rem;
    color: #6c757d;
    margin: 0;
  }

  .stat-value {
    font-size: 1.15rem;
    font-weight: 700;
    margin: 0;
  }

  .stat-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 0.75rem;
  }
</style>
<div class="page-body">
  {% include 'layout/breadcrumb.html' %}
  {% include 'messages.html' %}

  <!-- Container-fluid starts-->
  <div class="container-fluid list-products">
    <div class="row">
      <div class="card stat-card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="mb-0">Ringkasan Anggota</h5>
            <small class="text-muted">Total anggota: {{ people|length }}</small>
          </div>

          <div class="stat-grid">
            {% for p in people %}
            <div class="bg-white rounded-3 border stat-item">
              <div style="flex:1">
                <p class="stat-title mb-1">{{ p.name }}</p>
                <p class="stat-value mb-0">Rp. {{ p.amount|floatformat:"0g" }}</p>
              </div>

              <!-- icon SVG (sama untuk semua; kalau mau berbeda, tambahkan key icon di dict) -->
              <svg class="stat-icon" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M22.5938 14.1562V17.2278C20.9604 17.8102 19.7812 19.3566 19.7812 21.1875C19.7812 23.5138 21.6737 25.4062 24 25.4062C24.7759 25.4062 25.4062 26.0366 25.4062 26.8125C25.4062 27.5884 24.7759 28.2188 24 28.2188C23.2241 28.2188 22.5938 27.5884 22.5938 26.8125H19.7812C19.7812 28.6434 20.9604 30.1898 22.5938 30.7722V33.8438H25.4062V30.7722C27.0396 30.1898 28.2188 28.6434 28.2188 26.8125C28.2188 24.4862 26.3263 22.5938 24 22.5938C23.2241 22.5938 22.5938 21.9634 22.5938 21.1875C22.5938 20.4116 23.2241 19.7812 24 19.7812C24.7759 19.7812 25.4062 20.4116 25.4062 21.1875H28.2188C28.2188 19.3566 27.0396 17.8102 25.4062 17.2278V14.1562H22.5938Z"
                  fill="#28a745" />
              </svg>
            </div>
            {% endfor %}
          </div>

        </div>
      </div>
    </div>
    <div class="row">
      <div class="card stat-card">
        <div class="card-header pb-0">
          <div class="order-place" style="text-align: right;">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
              Tambah Hutang
            </button>
          </div>
        </div>
        <div class="card-body">
          <!-- <div class="table-responsive"> -->
          <table class="table table-bordered display table-striped dataTable no-footer" id="basic-1">
            <thead>
              <tr>
                <th rowspan="2">NO</th>
                <th rowspan="2" scope="col" class="text-center">TANGGAL</th>
                <th rowspan="2" scope="col" class="text-center">PEGAWAI</th>
                <th rowspan="2" scope="col" class="text-center">KETERANGAN</th>
                <th colspan="2" scope="col" class="text-center">JENIS</th>
                <th rowspan="2" scope="col" class="text-center">OPSI</th>
              </tr>
              <tr>
                <th scope="col" class="text-center">HUTANG</th>
                <th scope="col" class="text-center">PIUTANG</th>
              </tr>
            </thead>
            <tbody>
              {% for u in data %}
              <tr class="text-center">
                <td>{{forloop.counter}}</td>
                <td>{{u.tanggal|date:"d-m-Y"}}</td>
                <td>{{u.pegawai}}</td>
                <td>{{u.keterangan}}</td>
                <td class="text-center">
                  {% if u.hutang_choice == "H" %}
                  Rp. {{u.jumlah|floatformat:"0g" }}
                  {% else %}
                  -
                  {% endif %}
                </td>
                <td class="text-center">
                  {% if u.hutang_choice == "P" %}
                  Rp. {{u.jumlah|floatformat:"0g" }}
                  {% else %}
                  -
                  {% endif %}
                </td>
                <td>
                  <button type="button" class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#edit_tr">
                    <i class="fa fa-cog"></i>
                  </button>
                  <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal"
                    data-bs-target="#hapus_hut">
                    <i class="fa fa-trash"></i>
                  </button>
                </td>
              </tr>
              <div class="modal fade" id="hapus_hut" tabindex="-1" aria-labelledby="hapus_hut" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="hapus_hut">
                        Hapus hutang</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </button>
                    </div>
                    <div class="modal-body">
                      Apakah Kamu yakin ingin menghapus tabel hutang ini:
                      <h4 class="bold">
                        {{u.pegawai}} dengan nomer id {{u.id}}
                      </h4>
                    </div>
                    <div class="card-footer border-0 pt-0" style="text-align: right;">
                      <button class="btn btn-warning" type="reset">Cancel</button>
                      <a href="{% url 'DeleteHutangPeg' u.id %}" class="text-decoration-none">
                        <button type="button" class="btn btn-danger">Delete</button>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal fade" id="edit_tr" tabindex="-1" aria-labelledby="edit_tr" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5" id="edit_tr">Edit Transaksi</h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <form class="form theme-form" action="{% url 'updatehut' u.id %}" method="POST"
                        enctype="multipart/form-data">
                        {% load crispy_forms_tags %}
                        {% csrf_token %}
                        {{form|crispy}}
                        <!-- <div class="mb-3">
                            <label class="col-form-label pt-0">Tanggal</label>
                            {{form.tanggal}}
                          </div>
                          <div class="mb-3">
                            <label class="col-form-label pt-0">Jenis</label>
                            {{form.hutang_choice}}
                          </div>
                          <div class="mb-3">
                            <label class="col-form-label pt-0">Nominal</label>
                            {{form.jumlah}}
                          </div>
                          <div class="mb-3">
                            <label class="col-form-label pt-0">Keterangan</label>
                            {{form.keterangan}}
                          </div> -->
                        {% if form.errors %}
                        <div class="alert alert-danger" id="msg">
                          {{ form.errors }}
                        </div>
                        {% endif %}
                        <div class="card-footer border-0 pt-0" style="text-align: right;">
                          <button class="btn btn-warning" type="reset">Cancel</button>
                          <button class="btn btn-primary" type="submit">Submit</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </tbody>
          </table>
          <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalLabel">Tambah Transaksi</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <form class="form theme-form" method="POST" enctype="multipart/form-data">
                    {% load crispy_forms_tags %}
                    {% csrf_token %}
                    <div class="mb-3">
                      <label class="col-form-label pt-0">Tanggal</label>
                      {{form.tanggal}}
                    </div>
                    <div class="mb-3">
                      <label class="col-form-label pt-0">Pegawai</label>
                      {{form.pegawai}}
                    </div>
                    <div class="mb-3">
                      <label class="col-form-label pt-0">Jenis</label>
                      {{form.hutang_choice}}
                    </div>
                    <div class="mb-3">
                      <label class="col-form-label pt-0">Nominal</label>
                      {{form.jumlah}}
                    </div>
                    <div class="mb-3">
                      <label class="col-form-label pt-0">Keterangan</label>
                      {{form.keterangan}}
                    </div>
                    {% if form.errors %}
                    <div class="alert alert-danger" id="msg">
                      {{ form.errors }}
                    </div>
                    {% endif %}
                    <div class="card-footer border-0 pt-0" style="text-align: right;">
                      <button class="btn btn-warning" type="reset">Cancel</button>
                      <button class="btn btn-primary" type="submit">Submit</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
{% endblock content %}
{% block scriptcontent %}
<!-- Plugins JS start-->
<script src="{% static 'assets/js/sidebar-menu.js' %}"></script>
<script src="{% static 'assets/js/datatable/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'assets/js/rating/jquery.barrating.js' %}"></script>
<script src="{% static 'assets/js/rating/rating-script.js' %}"></script>
<script src="{% static 'assets/js/owlcarousel/owl.carousel.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>

<script src="{% static 'assets/js/ecommerce.js' %}"></script>
<script src="{% static 'assets/js/product-list-custom.js' %}"></script>
<!-- Plugins JS Ends-->
{% endblock scriptcontent %}